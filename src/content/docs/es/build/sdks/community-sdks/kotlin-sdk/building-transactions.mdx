---
title: "Construir y Enviar Transacciones"
description: "Construye, firma y envía transacciones en Aptos con Kaptos usando el nuevo DSL lean"
sidebar:
  label: "Construir Transacciones"
---

import { Aside } from '@astrojs/starlight/components';

Kaptos ofrece dos formas de ejecutar transacciones:

- un **flujo componible** (`buildSimpleTransaction` -> `sign` -> `submitTransaction.simple`)
- un **flujo de una llamada** (`execute`) para ejecución común con un solo firmante

Esta guía usa la API lean más reciente (`typeArgs(...)`, `args(...)`).

## Crear una cuenta

Primero genera credenciales y luego financia la dirección en una red de prueba.

```kotlin
val aptos = Aptos(AptosConfig(AptosSettings(network = Network.DEVNET)))

val alice = Account.generate()
val bob = Account.generate()

aptos.fundAccount(alice.accountAddress, 100_000_000L).expect("Failed to fund Alice")
aptos.fundAccount(bob.accountAddress, 100_000_000L).expect("Failed to fund Bob")
```

Para cuentas derivadas desde clave privada, revisa [Cuentas](/es/build/sdks/community-sdks/kotlin-sdk/account).

## Construir la transacción

Usa `buildSimpleTransaction` con el builder lean de entry function.

```kotlin
val txn =
  aptos.buildSimpleTransaction(sender = alice.accountAddress) {
    function = "0x1::coin::transfer"
    typeArgs("0x1::aptos_coin::AptosCoin")
    args(
      bob.accountAddress,
      1_000_000UL,
    )
  }
```

`args(...)` hace coerción automática Kotlin -> Move para tipos comunes (`Boolean`, `Int`, `ULong`, `String`, `ByteArray`, `List<T>`, `AccountAddress`, etc.), por lo que normalmente no necesitas wrappers explícitos.

Si necesitas ajustar parámetros de gas/secuencia:

```kotlin
val txn =
  aptos.buildSimpleTransaction(
    sender = alice.accountAddress,
    options = InputGenerateTransactionOptions(maxGasAmount = 20_000),
  ) {
    function = "0x1::coin::transfer"
    typeArgs("0x1::aptos_coin::AptosCoin")
    args(bob.accountAddress, 1_000_000UL)
  }
```

## Sign the transaction

Usa `sign` cuando quieres controlar explícitamente la autenticación antes del envío.

```kotlin
val senderAuthenticator = aptos.sign(signer = alice, transaction = txn)
```

## Submit the transaction

Envía la transacción raw junto con el autenticador del remitente.

```kotlin
val pendingTxn =
  aptos
    .submitTransaction.simple(
      transaction = txn,
      senderAuthenticator = senderAuthenticator,
    )
    .expect("Failed to submit transaction")
```

## Esperar ejecución

Espera confirmación en cadena con el hash pendiente.

```kotlin
val executedTxn =
  aptos
    .waitForTransaction(HexInput.fromString(pendingTxn.hash))
    .expect("Transaction did not execute successfully")
```

## Ejecutar en una sola llamada

Si no necesitas inspeccionar objetos intermedios (transacción/autenticador), usa `execute`:

```kotlin
val pendingTxn =
  aptos
    .execute(signer = alice) {
      function = "0x1::coin::transfer"
      typeArgs("0x1::aptos_coin::AptosCoin")
      args(bob.accountAddress, 1_000_000UL)
    }
    .expect("Failed to build/sign/submit transaction")
```

Luego espera confirmación de forma normal:

```kotlin
val executedTxn =
  aptos
    .waitForTransaction(HexInput.fromString(pendingTxn.hash))
    .expect("Transaction did not execute successfully")
```

<Aside type="note" emoji="ℹ️">
  Las APIs anteriores siguen disponibles (`buildTransaction.simple`, `entryFunctionData { typeArguments = ...; functionArguments = ... }`, y `signAndSubmitTransaction`). Para código nuevo, la API lean es la opción recomendada.
</Aside>
