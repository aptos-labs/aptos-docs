---
title: "Gu칤a de Migraci칩n"
description: "Gu칤a completa para migrar desde el SDK TypeScript legacy (v1.x.x) al nuevo paquete @aptos-labs/ts-sdk"
sidebar:
  label: "Gu칤a de Migraci칩n"
---

import { Aside } from '@astrojs/starlight/components';

<Aside emoji="游뚿" type="danger">
  El paquete SDK TypeScript Legacy `aptos` est치 deprecado y ser치 reemplazado por el nuevo SDK TypeScript. Por favor consulta el [nuevo SDK TypeScript](/es/build/sdks/ts-sdk) para las 칰ltimas caracter칤sticas y actualizaciones.
</Aside>

Si vienes de una versi칩n anterior `1.x.x` de `aptos`, necesitar치s hacer las siguientes actualizaciones.

<Aside type="note">
  Esta gu칤a solo contiene diferencias de API y actualizaciones requeridas para caracter칤sticas deprecadas. Las nuevas caracter칤sticas del SDK v2 no est치n incluidas.
</Aside>

## Instalar el SDK

El SDK TypeScript V2 est치 bajo un nuevo [repositorio GitHub](https://github.com/aptos-labs/aptos-ts-sdk) y con un nuevo nombre de paquete - `@aptos-labs/ts-sdk`

```shellscript npm2yarn
npm i @aptos-labs/ts-sdk
```

## Uso del SDK y consulta de la cadena Aptos

Remueve todos los m칩dulos `<*>Client` (i.e `AptosClient`, `FaucetClient`, `CoinClient`, etc.) y reemplaza con una clase de punto de entrada `Aptos`

**V1**

```typescript filename="v1.ts"
const faucetClient = new FaucetClient(NODE_URL, FAUCET_URL);
const aptosClient = new AptosClient(NODE_URL);
const indexerClient = new IndexerClient(INDEXER_URL);
const tokenClient = new TokenClient(aptosClient);
```

**V2**

<Aside type="note">
  Lee m치s sobre esto [aqu칤](/es/build/sdks/ts-sdk).
</Aside>

```typescript filename="v2.ts"
const aptos = new Aptos();

// hacer consultas
const fund = await aptos.fundAccount({ accountAddress: "0x123", amount: 100 });
const modules = await aptos.getAccountModules({ accountAddress: "0x123" });
const tokens = await aptos.getAccountOwnedTokens({ accountAddress: "0x123" });
```

## Clase de configuraci칩n

Para configurar tu cliente `Aptos`, puedes usar un objeto `AptosConfig`.

```typescript filename="v2.ts"
const aptosConfig = new AptosConfig({ network: Network.DEVNET }); // por defecto a devnet
const aptos = new Aptos(config);
```

## Flujo del Constructor de Transacciones

Removidas todas las funciones de transacci칩n separadas en favor de un flujo constructor de transacciones m치s simplificado y amigable

**V1**

```typescript filename="v1.ts"
const aptosClient = new AptosClient(NODE_URL);

// payload de argumentos serializados bcs
const entryFunctionPayload =
  new TxnBuilderTypes.TransactionPayloadEntryFunction(
    TxnBuilderTypes.EntryFunction.natural(
      "0x1::aptos_account",
      "transfer",
      [],
      [bcsToBytes(TxnBuilderTypes.AccountAddress.fromHex(receiver.address()))],
    ),
  );
// generar una transacci칩n cruda
const transaction = await client.generateRawTransaction(
  sender.address(),
  entryFunctionPayload,
);

// payload de argumentos no serializados
const payload: Gen.TransactionPayload = {
  type: "entry_function_payload",
  function: "0x1::aptos_account::transfer",
  type_arguments: [],
  arguments: [account2.address().hex(), 100000],
};
// generar una transacci칩n cruda
const transaction = await client.generateTransaction(
  account1.address(),
  payload,
);

// firmar transacci칩n
const signedTransaction = AptosClient.generateBCSTransaction(
  sender,
  transaction,
);
// enviar transacci칩n
const txn = await client.submitSignedBCSTransaction(signedTransaction);
```

**V2**

<Aside type="note">
  Lee m치s sobre esto [aqu칤](/es/build/sdks/ts-sdk/building-transactions).
</Aside>

```typescript filename="v2.ts"
const aptos = new Aptos();

// transacci칩n de argumentos no serializados
const transaction = await aptos.build.transaction({
  sender: alice.accountAddress,
  data: {
    function: "0x1::coin::transfer",
    typeArguments: ["0x1::aptos_coin::AptosCoin"],
    functionArguments: [bobAddress, 100],
  },
});

// transacci칩n de argumentos serializados bcs
const transaction = await aptos.build.transaction({
  sender: alice.accountAddress,
  data: {
    function: "0x1::coin::transfer",
    typeArguments: [parseTypeTag("0x1::aptos_coin::AptosCoin")],
    functionArguments: [bobAddress, new U64(100)],
  },
});
// firmar transacci칩n
const senderAuthenticator = aptos.sign.transaction({
  signer: alice,
  transaction,
});
// enviar transacci칩n
const committedTransaction = await aptos.submit.transaction({
  transaction,
  senderAuthenticator,
});
```

## Cuenta

Renombra `AptosAccount` a `Account` y usa m칠todos est치ticos para generar / derivar una cuenta

**V1**

```typescript filename="v1.ts"
// generar una nueva cuenta (o par de claves) O derivar de clave privada O derivar de clave privada y direcci칩n
const account = new AptosAccount(); // soporta solo Legacy Ed25519

// derivar cuenta de ruta de derivaci칩n
const account = AptosAccount.fromDerivePath(..)
```

**V2**

<Aside type="note">
  Lee m치s sobre esto [aqu칤](/es/build/sdks/ts-sdk/account).
</Aside>

```typescript filename="v2.ts"
// generar una nueva cuenta (o par de claves)
const account = Account.generate(); // por defecto a Legacy Ed25519
const account = Account.generate({ scheme: SigningSchemeInput.Secp256k1Ecdsa }); // Single Sender Secp256k1
const account = Account.generate({
  scheme: SigningSchemeInput.Ed25519,
  legacy: false,
}); // Single Sender Ed25519

// derivar cuenta de clave privada
const account = Account.fromPrivateKey({ privateKey });

// derivar cuenta de clave privada y direcci칩n
const account = Account.fromPrivateKeyAndAddress({
  privateKey,
  address: accountAddress,
});

// derivar cuenta de ruta de derivaci칩n
const account = Account.fromDerivationPath({
  path,
  mnemonic,
  scheme: SigningSchemeInput.Ed25519,
});
```
