---
title: "Tarifas de Gas y Almacenamiento"
---

import { Aside } from '@astrojs/starlight/components';

Cualquier ejecuci贸n de transacci贸n en la blockchain de Aptos requiere una tarifa de procesamiento. A la fecha, esta tarifa comprende dos componentes:

1. Costos de ejecuci贸n e I/O

- Esto cubre tu uso de recursos de computaci贸n transitorios, como procesar tus transacciones y propagar el registro validado a trav茅s de la red distribuida de la red principal.
- Se mide en Unidades de Gas cuyo precio puede fluctuar seg煤n la carga de la red. Esto permite que los costos de ejecuci贸n e I/O sean bajos cuando la red est谩 menos ocupada.
- Esta porci贸n del gas se quema permanentemente al ejecutar una transacci贸n.

2. Tarifas de almacenamiento

- Esto cubre el costo de almacenar persistentemente el registro validado en el almacenamiento distribuido de la blockchain.
- Se mide en precios fijos de APT, por lo que el costo de almacenamiento permanente se mantiene estable incluso cuando el precio de la unidad de gas fluct煤a con la carga transitoria de la red.
- La tarifa de almacenamiento puede ser reembolsada cuando se elimina la ranura de almacenamiento asignada. Actualmente, la red est谩 configurada para reembolsar la totalidad de la tarifa de almacenamiento pagada durante el tiempo de vida de una ranura de almacenamiento de estado.
- Para mantener simple la implementaci贸n del sistema, esta porci贸n del gas se quema y se acu帽a nuevamente al momento del reembolso.

<Aside type="note">
  Conceptualmente, esta tarifa puede pensarse como muy similar a c贸mo pagamos por nuestros servicios dom茅sticos de electricidad o agua.
</Aside>

## Unidad de gas

Las transacciones pueden variar desde simples y econ贸micas hasta complicadas seg煤n lo que hagan. En la blockchain de Aptos, una **unidad de gas** representa una unidad b谩sica de consumo para recursos transitorios, como hacer computaci贸n o acceder al almacenamiento. Esto 煤ltimo no debe confundirse con el aspecto de almacenamiento a largo plazo de tales operaciones, ya que eso est谩 cubierto por las tarifas de almacenamiento por separado.

Ver [C贸mo Funciona el Gas Base](/es/network/blockchain/base-gas) para una descripci贸n detallada de los tipos de tarifas de gas y las optimizaciones disponibles.

<Aside type="note">
   Una **unidad de gas** es un n煤mero adimensional o una unidad que no est谩 asociada con ning煤n elemento como una moneda, expresada como un entero. Las unidades totales de gas consumidas por tu transacci贸n dependen de la complejidad de tu transacci贸n. El **precio del gas**, por otro lado, se expresa en t茅rminos de la moneda nativa de la blockchain de Aptos [APT](/es/network/glossary#apt) y su subunidad [Octas](/es/network/glossary#octa). Ver tambi茅n [Transacciones y Estados](/es/network/blockchain/txns-states) para c贸mo se ve una transacci贸n enviada a la blockchain de Aptos.
</Aside>

## La Declaraci贸n de Tarifas

A partir del lanzamiento 1.7 del Marco de Aptos, el desglose de cargos y reembolsos de tarifas se emite como un evento de m贸dulo representado por la estructura `0x1::transaction_fee::FeeStatement`.

```move filename="transaction_fee.move"
#[event]
/// Desglose de cargo y reembolso de tarifa para una transacci贸n.
/// La estructura es:
///
/// - Cargo neto o reembolso (no en la declaraci贸n)
///    - cargo total: total_charge_gas_units, coincide con `gas_used` en el `TransactionInfo` en cadena.
///      Esta es la suma de los sub-elementos a continuaci贸n. Nota que hay p茅rdida potencial de precisi贸n cuando
///      la conversi贸n entre unidades de gas internas y externas y entre token nativo y unidades de gas,
///      por lo que es posible que los n煤meros no sumen exactamente. -- Este n煤mero es el cargo final,
///      mientras que el desglose es meramente informativo.
///        - cargo de gas para ejecuci贸n (tiempo de CPU): `execution_gas_units`
///        - cargo de gas para IO (acceso aleatorio al almacenamiento): `io_gas_units`
///        - cargo de tarifa de almacenamiento (espacio de almacenamiento): `storage_fee_octas`, para ser incluido en
///          `total_charge_gas_unit`, este n煤mero se convierte a unidades de gas seg煤n el
///          `gas_unit_price` especificado por el usuario en la transacci贸n.
///    - reembolso por eliminaci贸n de almacenamiento: `storage_fee_refund_octas`, esto no est谩 incluido en `gas_used` o
///      `total_charge_gas_units`, el cargo neto / reembolso se calcula por
///      `total_charge_gas_units` * `gas_unit_price` - `storage_fee_refund_octas`.
///
/// Esto est谩 destinado a ser emitido como un evento de m贸dulo.
struct FeeStatement has drop, store {
    /// Cargo total de gas.
    total_charge_gas_units: u64,
    /// Cargo de gas de ejecuci贸n.
    execution_gas_units: u64,
    /// Cargo de gas de IO.
    io_gas_units: u64,
    /// Cargo de tarifa de almacenamiento.
    storage_fee_octas: u64,
    /// Reembolso de tarifa de almacenamiento.
    storage_fee_refund_octas: u64,
}
```

## Precio del gas y priorizaci贸n de transacciones

En la red de Aptos, la gobernanza de Aptos establece el precio m铆nimo absoluto de la unidad de gas. Sin embargo, el mercado determina qu茅 tan r谩pido se procesa una transacci贸n con un precio particular de unidad de gas. Ver [Rastreador de Gas de Ethereum](https://etherscan.io/gastracker), por ejemplo, que muestra los movimientos de precios del mercado del precio del gas de Ethereum.

Al especificar un precio de unidad de gas m谩s alto que el precio actual del mercado, puedes **aumentar** el nivel de prioridad para tu transacci贸n en la blockchain pagando una tarifa de procesamiento mayor. Como parte del consenso, cuando el l铆der selecciona transacciones de su mempool para proponer como parte del siguiente bloque, priorizar谩 seleccionar transacciones con un precio de unidad de gas m谩s alto. Ten en cuenta que las tarifas de gas m谩s altas solo priorizan la selecci贸n de transacciones para el siguiente bloque.

## Estimaci贸n de tarifas de gas

Para estimar las tarifas de gas para una transacci贸n:

### Usando la API REST

Puedes usar el endpoint de simulaci贸n para estimar los costos de gas:

```bash
curl -X POST "https://api.mainnet.aptoslabs.com/v1/transactions/simulate" \
  -H "Content-Type: application/json" \
  -d '{
    "sender": "0x123...",
    "sequence_number": "1",
    "max_gas_amount": "100000",
    "gas_unit_price": "100",
    "expiration_timestamp_secs": "...",
    "payload": {...}
  }'
```

### Usando el SDK de TypeScript

```typescript
import { Aptos, AptosConfig, Network } from "@aptos-labs/ts-sdk";

const config = new AptosConfig({ network: Network.MAINNET });
const aptos = new Aptos(config);

// Simular transacci贸n para estimar gas
const simulation = await aptos.transaction.simulate.simple({
  signerPublicKey: account.publicKey,
  transaction,
});

console.log(`Gas estimado: ${simulation[0].gas_used}`);
console.log(`Costo estimado: ${simulation[0].gas_used * gasUnitPrice} octas`);
```

## Mejores pr谩cticas para tarifas de gas

1. **Establece l铆mites razonables**: Configura `max_gas_amount` lo suficientemente alto para cubrir tu transacci贸n pero no excesivamente alto.

2. **Monitorea los precios del mercado**: Ajusta tu `gas_unit_price` basado en las condiciones actuales de la red.

3. **Usa simulaci贸n**: Siempre simula transacciones complejas antes de enviarlas para estimar costos precisos.

4. **Considera los costos de almacenamiento**: Para transacciones que crean nuevos recursos, ten en cuenta las tarifas de almacenamiento adicionales.

## Factores que afectan las tarifas de gas

### Complejidad de la transacci贸n

- Funciones Move simples consumen menos gas
- Operaciones complejas con m煤ltiples llamadas de funci贸n cuestan m谩s
- Acceso a almacenamiento a帽ade costos de I/O

### Tama帽o de los datos

- Transacciones m谩s grandes requieren m谩s gas para procesamiento
- Almacenar datos m谩s grandes incurre en tarifas de almacenamiento m谩s altas

### Condiciones de la red

- Alta congesti贸n aumenta los precios de gas
- Periodos de baja actividad resultan en tarifas m谩s baratas

***

Para informaci贸n m谩s detallada sobre la estructura interna del gas y optimizaciones, consulta la [documentaci贸n completa](/es/network/blockchain/gas-txn-fee) en ingl茅s.
