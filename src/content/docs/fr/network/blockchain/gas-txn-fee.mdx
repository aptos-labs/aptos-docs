---
title: "Frais de Gaz et de Stockage"
---

import { Aside } from '@astrojs/starlight/components';

Toute ex√©cution de transaction sur la blockchain Aptos n√©cessite des frais de traitement. √Ä ce jour, ces frais comprennent deux composants :

1. Co√ªts d'ex√©cution et d'E/S

- Cela couvre votre utilisation de ressources de calcul transitoires, telles que le traitement de vos transactions et la propagation de l'enregistrement valid√© √† travers le r√©seau distribu√© du mainnet.
- Il est mesur√© en Unit√©s de Gaz dont le prix peut fluctuer selon la charge du r√©seau. Cela permet aux co√ªts d'ex√©cution et d'E/S d'√™tre faibles quand le r√©seau est moins occup√©.
- Cette portion du gaz est br√ªl√©e de fa√ßon permanente lors de l'ex√©cution d'une transaction.

2. Frais de stockage

- Cela couvre le co√ªt pour stocker de fa√ßon persistante l'enregistrement valid√© dans le stockage blockchain distribu√©.
- Il est mesur√© en prix APT fixes, donc le co√ªt de stockage permanent reste stable m√™me quand le prix des unit√©s de gaz fluctue avec la charge transitoire du r√©seau.
- Les frais de stockage peuvent √™tre rembours√©s quand l'emplacement de stockage allou√© est supprim√©. Actuellement, le r√©seau est configur√© pour rembourser l'int√©gralit√© des frais de stockage pay√©s au cours de la dur√©e de vie d'un emplacement de stockage d'√©tat.
- Pour garder l'impl√©mentation syst√®me simple, cette portion du gaz est br√ªl√©e et frapp√©e √† nouveau lors du remboursement.

<Aside type="note">
  Conceptuellement, ces frais peuvent √™tre consid√©r√©s comme assez similaires √† la fa√ßon dont nous payons nos utilitaires domestiques d'√©lectricit√© ou d'eau.
</Aside>

## Unit√© de gaz

Les transactions peuvent aller de simples et peu co√ªteuses √† compliqu√©es selon ce qu'elles font. Dans la blockchain Aptos, une **unit√© de gaz** repr√©sente une unit√© de base de consommation pour les ressources transitoires, telles que faire du calcul ou acc√©der au stockage. Cette derni√®re ne doit pas √™tre confondue avec l'aspect de stockage √† long terme de telles op√©rations, car cela est couvert s√©par√©ment par les frais de stockage.

Voir [Comment Fonctionne le Gaz de Base](/fr/network/blockchain/base-gas) pour une description d√©taill√©e des types de frais de gaz et des optimisations disponibles.

<Aside type="note">
  üëâ Une **unit√© de gaz** est un nombre sans dimension ou une unit√© qui n'est associ√©e √† aucun √©l√©ment particulier tel qu'une pi√®ce, exprim√©e comme un entier. Les unit√©s de gaz totales consomm√©es par votre transaction d√©pendent de la complexit√© de votre transaction. Le **prix du gaz**, d'autre part, est exprim√© en termes de pi√®ce native de la blockchain Aptos [APT](/fr/network/glossary#apt) et de sa sous-unit√© [Octas](/fr/network/glossary#octa). Voir aussi [Transactions et √âtats](/fr/network/blockchain/txns-states) pour comment une transaction soumise √† la blockchain Aptos ressemble.
</Aside>

## La D√©claration de Frais

√Ä partir de la version 1.7 du Framework Aptos, la ventilation des charges et remboursements de frais est √©mise comme un √©v√©nement de module repr√©sent√© par la structure `0x1::transaction_fee::FeeStatement`.

```move filename="transaction_fee.move"
#[event]
/// Ventilation des charges et remboursements de frais pour une transaction.
/// La structure est :
///
/// - Charge ou remboursement net (pas dans la d√©claration)
///    - charge totale : total_charge_gas_units, correspond √† `gas_used` dans le `TransactionInfo` sur la cha√Æne.
///      Ceci est la somme des sous-√©l√©ments ci-dessous. Notez qu'il y a une perte de pr√©cision potentielle lors de
///      la conversion entre les unit√©s de gaz internes et externes et entre le jeton natif et les unit√©s de gaz,
///      donc il est possible que les nombres ne s'additionnent pas exactement. -- Ce nombre est la charge finale,
///      tandis que la ventilation est simplement informative.
///      - ex√©cution : execution_gas_units
///      - E/S : io_gas_units
///      - stockage : storage_fee_octas, converti en unit√©s de gaz selon rate
///    - remboursement total : total_refund_gas_units
///      - frais de stockage rembours√©s : storage_fee_refund_octas, converti en unit√©s de gaz selon rate
///
/// Le prix du gaz unitaire applicable peut √™tre trouv√© dans les informations de transaction.
struct FeeStatement has copy, drop, store {
    /// Unit√©s de gaz totales factur√©es.
    total_charge_gas_units: u64,
    /// Unit√©s de gaz d'ex√©cution factur√©es.
    execution_gas_units: u64,
    /// Unit√©s de gaz d'E/S factur√©es.
    io_gas_units: u64,
    /// Frais de stockage factur√©s en octas.
    storage_fee_octas: u64,
    /// Unit√©s de gaz totales rembours√©es.
    total_refund_gas_units: u64,
    /// Frais de stockage rembours√©s en octas.
    storage_fee_refund_octas: u64,
}
```

### Exemples de d√©clarations de frais

#### Transaction simple de transfert

Pour une transaction de transfert simple, vous pourriez voir quelque chose comme :

```json
{
  "total_charge_gas_units": "150",
  "execution_gas_units": "120", 
  "io_gas_units": "30",
  "storage_fee_octas": "0",
  "total_refund_gas_units": "0",
  "storage_fee_refund_octas": "0"
}
```

#### Transaction cr√©ant de nouvelles donn√©es

Quand une transaction cr√©e de nouvelles ressources sur la cha√Æne :

```json
{
  "total_charge_gas_units": "350",
  "execution_gas_units": "200",
  "io_gas_units": "50", 
  "storage_fee_octas": "1000",
  "total_refund_gas_units": "0",
  "storage_fee_refund_octas": "0"
}
```

#### Transaction supprimant des donn√©es

Quand une transaction supprime des ressources et obtient un remboursement :

```json
{
  "total_charge_gas_units": "180",
  "execution_gas_units": "150",
  "io_gas_units": "30",
  "storage_fee_octas": "0", 
  "total_refund_gas_units": "100",
  "storage_fee_refund_octas": "800"
}
```

## Prix du gaz et estimation

Le prix du gaz sur Aptos est dynamique et ajust√© selon la demande du r√©seau. Le r√©seau cible un d√©bit de transaction optimal et ajuste les prix pour maintenir des performances stables.

### Estimation des frais de transaction

Vous pouvez estimer les frais de votre transaction en utilisant :

1. **Simulation de transaction** - Ex√©cutez votre transaction en mode simulation pour voir les co√ªts en gaz
2. **Prix du gaz actuel** - Consultez le prix du gaz actuel du r√©seau via l'API REST
3. **Frais historiques** - Examinez des transactions similaires pour estimer les co√ªts

### Optimisation des co√ªts en gaz

- **Simplifiez la logique** - Les op√©rations plus simples co√ªtent moins de gaz
- **Lot de transactions** - Combinez plusieurs op√©rations quand possible
- **R√©utilisez les ressources** - √âvitez de cr√©er des ressources redondantes
- **Surveillez le timing** - Soumettez les transactions pendant les p√©riodes de faible demande

<Aside type="tip">
  Utilisez toujours la simulation de transaction avant de soumettre pour obtenir des estimations pr√©cises de gaz et √©viter les √©checs co√ªteux.
</Aside>
