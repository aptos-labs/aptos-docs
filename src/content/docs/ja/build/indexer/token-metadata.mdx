---
title: "名前によるトークンメタデータの取得"
---

import { Aside } from '@astrojs/starlight/components';

`GetTokensDataByName`は,指定されたコレクション内のトークン名に基づいてメタデータURIを取得します.このクエリは,コレクション内のトークンのメタデータを表示するマーケットプレイスにとって特に有用です.

<Aside type="note">
  このクエリの機能を探索してみましょう!以下の変数を変更してクエリをニーズに合わせてカスタマイズできます.
</Aside>

{/* <GraphQLEditor query={"type":"mdxJsxAttributeValueExpression","value":"`query GetTokensDataByName($token_name: String, $collectionId: String) {\ncurrent_token_datas_v2(\n  where: {token_name: {_eq: $token_name}, collection_id: {_eq: $collectionId}}\n) {\n  token_uri\n  __typename\n}\n}`","data":{"estree":{"type":"Program","start":339,"end":560,"body":[{"type":"ExpressionStatement","expression":{"type":"TemplateLiteral","start":339,"end":560,"loc":{"start":{"line":13,"column":9,"offset":339},"end":{"line":20,"column":2,"offset":560}},"expressions":[],"quasis":[{"type":"TemplateElement","start":340,"end":559,"loc":{"start":{"line":13,"column":10,"offset":340},"end":{"line":20,"column":1,"offset":559}},"value":{"raw":"query GetTokensDataByName($token_name: String, $collectionId: String) {\ncurrent_token_datas_v2(\n  where: {token_name: {_eq: $token_name}, collection_id: {_eq: $collectionId}}\n) {\n  token_uri\n  __typename\n}\n}","cooked":"query GetTokensDataByName($token_name: String, $collectionId: String) {\ncurrent_token_datas_v2(\n  where: {token_name: {_eq: $token_name}, collection_id: {_eq: $collectionId}}\n) {\n  token_uri\n  __typename\n}\n}"},"tail":true,"range":[340,559]}],"range":[339,560]},"start":339,"end":560,"loc":{"start":{"line":13,"column":9,"offset":339},"end":{"line":20,"column":2,"offset":560}},"range":[339,560]}],"sourceType":"module","comments":[],"loc":{"start":{"line":13,"column":9,"offset":339},"end":{"line":20,"column":2,"offset":560}},"range":[339,560]}}} variables={"type":"mdxJsxAttributeValueExpression","value":"`{\n\"token_name\": \"The Mexican\",\n\"collectionId\": \"0xe6a7399d10406b993e25d8a3bf24842413ba8f1a08444dbfa5f1c31b09f0d16e\"\n}`","data":{"estree":{"type":"Program","start":575,"end":698,"body":[{"type":"ExpressionStatement","expression":{"type":"TemplateLiteral","start":575,"end":698,"loc":{"start":{"line":21,"column":13,"offset":575},"end":{"line":24,"column":2,"offset":698}},"expressions":[],"quasis":[{"type":"TemplateElement","start":576,"end":697,"loc":{"start":{"line":21,"column":14,"offset":576},"end":{"line":24,"column":1,"offset":697}},"value":{"raw":"{\n\"token_name\": \"The Mexican\",\n\"collectionId\": \"0xe6a7399d10406b993e25d8a3bf24842413ba8f1a08444dbfa5f1c31b09f0d16e\"\n}","cooked":"{\n\"token_name\": \"The Mexican\",\n\"collectionId\": \"0xe6a7399d10406b993e25d8a3bf24842413ba8f1a08444dbfa5f1c31b09f0d16e\"\n}"},"tail":true,"range":[576,697]}],"range":[575,698]},"start":575,"end":698,"loc":{"start":{"line":21,"column":13,"offset":575},"end":{"line":24,"column":2,"offset":698}},"range":[575,698]}],"sourceType":"module","comments":[],"loc":{"start":{"line":21,"column":13,"offset":575},"end":{"line":24,"column":2,"offset":698}},"range":[575,698]}}}></GraphQLEditor> */}

#### 変数:

- `$token_name`: **String** - コレクション内で検索するトークンの名前.例: `"The Mexican"`
- `$collectionId`: **String** - コレクション名とクリエイターアドレスに基づいて計算されたコレクションID.例: `"0xe6a7399d10406b993e25d8a3bf24842413ba8f1a08444dbfa5f1c31b09f0d16e"`

### 注意

コレクションIDを取得するには,以下のPythonコードスニペットを使用できます:

```python
import hashlib

def standardized_address(creator_address: str) -> str:
    # '0x'プレフィックスが存在する場合は削除し、アドレスを64文字の長さにフォーマットする
    handle = creator_address.removeprefix("0x") if creator_address.startswith("0x") else creator_address
    return f"0x{handle:0>64}"

def sha256_hex(creator_address: str, collection_name: str) -> str:
    # クリエイターアドレスを処理
    processed_address = standardized_address(creator_address)
    
    # 処理済みのクリエイターアドレスとコレクション名を結合
    combined_string = f"{creator_address}::{collection_name}"
    # SHA256ハッシュを計算し、16進数文字列として返す
    return standardized_address(hashlib.sha256(combined_string.encode()).hexdigest())

# 使用例
creator_address = "0xc0e3fbf8ae61056d66ce624d71ccf1888f879355cc4e364ef117249b5e3160a8"
collection_name = "Aptomingos"
# コレクションIDは `0xe6a7399d10406b993e25d8a3bf24842413ba8f1a08444dbfa5f1c31b09f0d16e` です
print(sha256_hex(creator_address, collection_name))

```
