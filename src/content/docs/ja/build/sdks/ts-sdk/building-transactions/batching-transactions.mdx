---
title: "トランザクションのバッチ処理"
---

TypeScript SDKには,複数の独立したトランザクションをバッチとしてまとめて送信する機能が組み込まれています.これは,同じアカウントから複数のトランザクションを素早く実行する必要がある場合に便利なツールとなります.

以下の例のように,`aptos.transaction.batch.forSingleAccount`を使用して実行できます.

## TypeScriptの完全な例

```typescript filename="batch.ts"
/**
 * This example shows how to use the Aptos SDK to send several transactions in a batch.
 */

import {
    Account,
    Aptos,
    AptosConfig,
    Network,
    InputGenerateTransactionPayloadData,
} from "@aptos-labs/ts-sdk";

async function example() {
    console.log("This example will send several transactions in a batch.");

    // Setup the client and test accounts
    const config = new AptosConfig({ network: Network.DEVNET });
    const aptos = new Aptos(config);

    let sender = Account.generate();

    console.log("=== Addresses ===\n");
    console.log(`Sender's address is: ${sender.accountAddress}`);

    console.log("\n=== Funding sender ===\n");
    await aptos.fundAccount({
        accountAddress: sender.accountAddress,
        amount: 100_000_000,
    });  
    console.log("Funded the sender account!")

    // Generate several recipients to send APT to
    const recipients = [Account.generate(), Account.generate(), Account.generate()];

    // Create transactions to send APT to each account
    const transactions: InputGenerateTransactionPayloadData[] = [];

    for (let i = 0; i < recipients.length; i += 1) {
        const transaction: InputGenerateTransactionPayloadData = {
            function: "0x1::aptos_account::transfer",
            functionArguments: [recipients[i].accountAddress, 10],
        };
        transactions.push(transaction);
    }

    // Sign and submit all transactions as fast as possible (throws if any error)
    await aptos.transaction.batch.forSingleAccount({ sender: sender, data: transactions });
};

example();
```

## バッチ処理されたトランザクションのステータス確認

バッチで送信されたトランザクションがチェーン上で実行されたタイミングを知るには,プロセスの実行中にイベントをリッスンする必要があります.

```typescript filename="transaction-worker-events.ts"
export enum TransactionWorkerEventsEnum {
  // Fired after a transaction gets sent to the chain
  TransactionSent = "transactionSent",
  // Fired if there is an error sending the transaction to the chain
  TransactionSendFailed = "transactionSendFailed",
  // Fired when a single transaction has executed successfully
  TransactionExecuted = "transactionExecuted",
  // Fired if a single transaction fails in execution
  TransactionExecutionFailed = "transactionExecutionFailed",
  // Fired when the worker has finished its job / when the queue has been emptied
  ExecutionFinish = "executionFinish",
}
```

これらのイベントのリッスン方法の例は[こちら](https://github.com/aptos-labs/aptos-ts-sdk/blob/main/examples/typescript/batch_funds.ts#L108)でご覧いただけます.
